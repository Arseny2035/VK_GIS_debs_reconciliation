Приложение выполняет проверку вхождения абонентов водоканала
из списка запроса в список абонентов с задолженностью, у которых есть
открытые коллекторские кейсы.
Запросы получают из скачанного файла Excel системы ГИС.
Информация о случаях инкассации берется из корпоративного файла Excel,
который заполняются юристами.
Список совпадений сохраняется в файле отчета Excel.

1. Формат файла с запросом ГИС.
Для получения адреса используются данные столбца «Адрес дома». 
Программно убираются первые символы про индекс, район.

Город, улица, дом должны быть разделены запятыми. Для номера дома 
должно быть обозначение «д. ХХХ», где ХХХ номер дома. Пробел после точки.

Допускается использовать литеры номера дома в следующих вариантах:
а. «д. 6/А»
б. «д. 6, к. А»
в. «д. 6А»

Для получения квартиры используются данные столбца « Номер квартиры, комнаты, блока жилого дома» 
(перед словом «Номер» стоит пробел - согласно формату присланного ГИС файла). 

Для номера квартиры должно быть обозначение: «кв.ХХХ», где ХХХ номер квартиры. 
Без пробела после точки.

Литеры квартиры прописываются в удобном пользователю виде. 
Главное: обеспечить точное соответствие литера квартиры в файле ГИС с литером в файле ВК.
Примеры обозначения литера квартиры:
а. «кв.2»
б. «кв.2А»
в. «кв.2-А»
г. прочие варианты.

При сверке ГИС и ВК данных игнорируется регистр обозначения литера номера дома и квартиры. 
Например, «д. 16/А» = «д. 16а».

2. Формат файла с данными водоканала.
Данные берутся только из тех листов, где есть названии есть слово «приказы» или «иски».

В листах должны располагаться столбцы с названиями:
- «Населенный пункт» 
- «Улица»
- «Дом»
- «Литер / дробь»
- «Квартира»
- «Включать в сверку ГИС-АБО»

Столбцы можно располагать в любом порядке, главное – корректные названия.

Имя населенного пункта и улицы необходимо выбирать из выпадающего списка. Если в списке 
нет нужного имени (появилась новая улица или населенный пункт), тогда предварительно 
необходимо добавить новое название в соответствующий лист «Населенный_пункт», «Улица»
расположенный в файле реестра взысканий.

Если какую-либо запись больше не нужно использовать для сверок с запросом ГИС 
(например, запись потеряла актуальность из-за сроков), то в столбце «Включать в сверку ГИС-АБО» 
требуется указать «Нет».

3. Для сверки адресов используется встроенный справочник названий населенных пунктов и улиц. 
В справочниках прописано соответствие значений для ГИС и ВК вариантов. 

Например: ГИС вариант «ст-ца Кабардинская» соответствует ВК вариант «Кабардинская ст», 
ГИС «ул 22 Партсъезда» соответствует ВК «22-го Партсъезда ул». 

ВК варианты были взяты и прочих реестров водоканала.

4. Если в ГИС запросе появится новое название, которого еще нет во встроенном справочнике, 
то программа при формировании отчета, продемонстрирует форму с запросом на ввод имени, принятого в ВК.  
Имя нужно взять из списков имен уже закрепленных в реестрах ВК.  
Заранее предусмотреть загрузку соответствий названий для всех ГИС имен не представляется возможным, 
т.к. нет точного понимания, какое именно имя получит в запросе та или иная улица (или населенный пункт). 
Например «ул Степана Разина», отражено в ГИС как «ул. С.Разина». 

5. Для названий буквы «Е» и «Ё» - различаются. По этой причине в встроенном в программу справочнике улиц, 
например, есть записи «ул Зеленая» и «ул Зелёная». Запросы в ГИС файле поступают и по той, и по другой улице. 
Справочник программы настроен так, чтобы считать эти названия одинаковыми (в данном случае в реестрах ВК 
будет просматриваться название «Зеленая ул»). Периодически могут возникать подобные коллизии.

6. Если существенно поменялся принцип наименования населенных пунктов и улиц, можно сделать глобальную 
перезагрузку справочников. Для этого следует отразить все изменения в наименованиях улиц 
и населенных пунктов в прилагающемся с программой файле справочников «dict.xlsx». 
После внесения всех изменений, необходимо удалить из корневой папки программы файл базы данных «data.pkl». 
Затем следует запустить программу, указать пути к файлу ГИС, файлу ВК и путь для сохранения отчета, 
нажать кнопку «Создать словари». 

Доступ к кнопке «Создать словари» появится после указания путей во всех трех полях на главной форме. 
Пути указываются не вручную, а с помощью соответствующего диалога, открывающегося по нажатию 
кнопки-иконки в виде папки (отдельной для каждой строки).






